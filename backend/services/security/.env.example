# Security Service Environment Variables

# Server Configuration
NODE_ENV=development
PORT=3006
LOG_LEVEL=info

# Database Configuration
MONGODB_URI=mongodb://localhost:27017/reskflow_security
DATABASE_NAME=reskflow_security

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_PREFIX=reskflow:security:

# Master Encryption Key (Base64 encoded)
# WARNING: Store this securely in production (HSM, Key Vault, etc.)
MASTER_ENCRYPTION_KEY=

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# Session Configuration
SESSION_TIMEOUT=86400
SESSION_SECRET=your-session-secret-change-in-production
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION=900

# Rate Limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_THRESHOLD=100

# Request Size Limits
MAX_REQUEST_SIZE=10485760
MAX_FILE_SIZE=52428800

# Encryption Configuration
ENCRYPTION_ALGORITHM=aes-256-gcm
KEY_DERIVATION_ITERATIONS=100000
KEY_ROTATION_INTERVAL=30

# Audit Configuration
AUDIT_RETENTION_DAYS=365
AUDIT_LOG_LEVEL=info
REAL_TIME_MONITORING=true

# Compliance Configuration
GDPR_ENABLED=true
DATA_RETENTION_DEFAULT=365
ANONYMIZATION_DELAY=30

# Threat Detection Configuration
THREAT_DETECTION_ENABLED=true
SCAN_INTERVAL=240
AUTO_BLOCK_ENABLED=true
IP_BLACKLIST_THRESHOLD=10

# Security Headers
CSP_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# MFA Configuration
MFA_ISSUER=ReskFlow
MFA_BACKUP_CODES=10
TOTP_WINDOW=2

# External Services
# AWS KMS (Optional)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_KMS_KEY_ID=

# Google Cloud KMS (Optional)
GOOGLE_CLOUD_PROJECT_ID=
GOOGLE_CLOUD_KMS_LOCATION=
GOOGLE_CLOUD_KMS_RING=
GOOGLE_CLOUD_KMS_KEY=

# HashiCorp Vault (Optional)
VAULT_ADDR=
VAULT_TOKEN=
VAULT_NAMESPACE=

# Alert Configuration
SLACK_WEBHOOK_URL=
EMAIL_SMTP_HOST=
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=
EMAIL_SMTP_PASS=
ALERT_EMAIL_FROM=
ALERT_EMAIL_TO=

# Monitoring
HEALTH_CHECK_INTERVAL=30000
METRICS_ENABLED=true
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Development Settings
DEBUG_MODE=false
VERBOSE_LOGGING=false
MOCK_EXTERNAL_SERVICES=false

# API Configuration
API_VERSION=1.0
CORS_ORIGINS=http://localhost:3000,https://app.reskflow.com
CORS_CREDENTIALS=true

# File Upload Security
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
ALLOWED_FILE_EXTENSIONS=jpg,jpeg,png,gif,pdf
MAX_FILES_PER_REQUEST=5

# Geographic Restrictions
GEO_RESTRICTION_ENABLED=false
ALLOWED_COUNTRIES=US,CA,GB,AU

# Time-based Access Control
TIME_RESTRICTION_ENABLED=false
ALLOWED_HOURS_START=9
ALLOWED_HOURS_END=17

# Backup and Recovery
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# Performance
CACHE_ENABLED=true
CACHE_TTL=3600
CONNECTION_POOL_SIZE=10
QUERY_TIMEOUT=30000

# Security Scanning
VULNERABILITY_SCAN_ENABLED=true
DEPENDENCY_CHECK_ENABLED=true
CODE_SCAN_ENABLED=true

# Custom Security Rules
CUSTOM_VALIDATION_RULES={}
CUSTOM_SANITIZATION_RULES={}
CUSTOM_THREAT_PATTERNS={}

# Notification Settings
NOTIFICATION_ENABLED=true
CRITICAL_ALERT_ENABLED=true
SECURITY_REPORT_ENABLED=true
WEEKLY_REPORT_ENABLED=true

# Testing Configuration (Development Only)
TEST_DATABASE_URI=mongodb://localhost:27017/reskflow_security_test
TEST_REDIS_URL=redis://localhost:6379/1
MOCK_SERVICES=false
TEST_ENCRYPTION_KEY=dGVzdC1lbmNyeXB0aW9uLWtleS1mb3ItdGVzdGluZw==

# Feature Flags
FEATURE_ADVANCED_THREATS=true
FEATURE_AI_DETECTION=false
FEATURE_BEHAVIORAL_ANALYSIS=false
FEATURE_REAL_TIME_BLOCKING=true